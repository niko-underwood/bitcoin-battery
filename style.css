/* Layout & theme */
:root{
  --bg:#0b1020;
  --fg:#e5e7eb;
  --muted:#94a3b8;
  --accent:#f59e0b;
  --green:#10b981;
  --danger:#ef4444;
  --slate:#1f2937;
  --slate2:#111827;
  --glass:rgba(255,255,255,0.06);
  --btc:#f7931a;
}
*{box-sizing:border-box}
html,body{margin:0;height:100%;background: radial-gradient(1200px 800px at 20% 0%, #0f172a 0%, #0b1020 50%, #070b18 100%);color:var(--fg);font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;}

.hud{
  position:sticky;top:0;z-index:20;display:flex;gap:16px;align-items:center;justify-content:space-between;
  padding:12px 16px;background:linear-gradient(180deg, rgba(3,7,18,0.9), rgba(3,7,18,0.6));
  border-bottom:1px solid rgba(255,255,255,0.08);backdrop-filter: blur(6px);
}
.title{font-weight:700;letter-spacing:0.3px}
.title .ver{color:var(--muted);font-size:12px;margin-left:6px}
.stats{display:flex;gap:18px;color:var(--muted)} .stats b{color:#fff}
.btn{background:linear-gradient(180deg,#1f2937,#111827);border:1px solid rgba(255,255,255,0.12);color:#fff;border-radius:12px;padding:8px 14px;cursor:pointer}
.btn:hover{filter:brightness(1.1)}

.playfield{display:grid;grid-template-columns: 1.2fr 1fr 1.2fr;gap:18px;padding:18px;min-height: calc(100vh - 140px);}

/* LEFT: Melting Ice Cube Area */
.left-side{display:flex;flex-direction:column;align-items:center;gap:10px}
.ice-area{
  position:relative;width:100%;height:560px;
  background:linear-gradient(180deg,#0e1a2d,#0b1424);
  border:1px solid rgba(255,255,255,0.08);border-radius:18px;
  box-shadow: inset 0 10px 40px rgba(0,0,0,0.45);
  padding:24px;overflow:hidden;
}
.ice-cube{
  --iceLevel: 1; /* 1 = full, 0 = gone */
  position:relative;margin:0 auto;margin-top:12px;width:70%;height:460px;border-radius:22px;
  background:linear-gradient(180deg, rgba(191,219,254,0.35), rgba(125,211,252,0.25));
  border:1px solid rgba(255,255,255,0.35);
  box-shadow: inset 0 20px 60px rgba(59,130,246,0.25), 0 10px 40px rgba(59,130,246,0.25);
  overflow:hidden;
}
.ice-cube::after{ /* frosty edges */
  content:"";position:absolute;inset:0;border-radius:22px;
  background: radial-gradient(600px 240px at 20% -10%, rgba(255,255,255,0.35), transparent),
              radial-gradient(600px 240px at 80% -10%, rgba(255,255,255,0.2), transparent);
  pointer-events:none;
}
.ice-fill{
  position:absolute;left:0;bottom:0;width:100%;height:calc(100% * var(--iceLevel));
  background:linear-gradient(180deg, rgba(191,219,254,0.6), rgba(125,211,252,0.55) 50%, rgba(59,130,246,0.45));
  box-shadow: inset 0 20px 60px rgba(59,130,246,0.35);
  transition:height 0.6s ease;
}
.frost{position:absolute;inset:0;background-image: radial-gradient(rgba(255,255,255,0.18) 1px, transparent 1px);background-size:8px 8px;opacity:0.35;mix-blend-mode:overlay}
.crack{position:absolute;background:linear-gradient(90deg, rgba(255,255,255,0.6), transparent);height:2px;opacity:0.45}
.c1{top:80px;left:30px;width:60%} .c2{top:210px;left:10%;width:70%} .c3{top:320px;left:20%;width:55%}
.drip{position:absolute;top:-12px;width:10px;height:20px;border-radius:6px;background:rgba(191,219,254,0.8);animation:drip 2.8s infinite ease-in}
.d1{left:22%} .d2{left:48%; animation-delay:0.8s} .d3{left:72%; animation-delay:1.6s}
@keyframes drip{0%{transform:translateY(0)} 60%{transform:translateY(420px)} 100%{transform:translateY(420px);opacity:0}}

.dollar-stack-illus{
  position:absolute;left:20px;bottom:20px;width:calc(100% - 40px);height:40%;
  background: repeating-linear-gradient(180deg, rgba(16,185,129,0.6), rgba(16,185,129,0.6) 6px, rgba(5,150,105,0.65) 6px, rgba(5,150,105,0.65) 12px);
  border:2px solid rgba(16,185,129,0.8);border-radius:10px;box-shadow: inset 0 8px 14px rgba(0,0,0,0.25);
  transform-origin: bottom; transition: transform 0.5s ease;
}
.tray{position:absolute;left:8%;right:8%;bottom:0;height:12px;border-radius:10px 10px 0 0;background:linear-gradient(180deg,#334155,#0f172a);box-shadow:0 -4px 10px rgba(0,0,0,0.3)}

/* CENTER: converter + tube */
.center-side{position:relative;display:flex;flex-direction:column;align-items:center;justify-content:center}
.mailbox{
  position:relative;width:220px;height:220px;border-radius:24px 24px 12px 12px;
  background:linear-gradient(180deg,#64748b,#334155);
  border:1px solid rgba(255,255,255,0.18);
  box-shadow: inset 0 12px 22px rgba(0,0,0,0.35), 0 10px 40px rgba(0,0,0,0.4);
}
.flag{position:absolute;right:-22px;top:36px;width:18px;height:70px;background:#f59e0b;border-radius:3px 3px 0 0;box-shadow:0 0 6px rgba(245,158,11,0.6)}
.slot{position:absolute;left:50%;transform:translateX(-50%);top:86px;width:140px;height:16px;border-radius:10px;background: linear-gradient(180deg,#111827,#000);box-shadow: inset 0 2px 6px rgba(0,0,0,0.9), 0 2px 0 rgba(255,255,255,0.06)}
.label{position:absolute;bottom:14px;width:100%;text-align:center;letter-spacing:2px;font-weight:800;color:#e2e8f0;font-size:12px;text-shadow:0 2px 0 rgba(0,0,0,0.2)}
.label.small{font-size:11px;letter-spacing:1.6px;padding:0 8px}

.tube{width:100%;height:180px;margin-top:16px;}

/* RIGHT: Giant Bitcoin Battery */
.right-side{display:flex;flex-direction:column;align-items:center;gap:10px}
.btc-battery{
  position:relative;width:460px;height:620px;border-radius:28px;background:linear-gradient(180deg,#1a0e00,#0c0700);
  border:1px solid rgba(255,255,255,0.15);
  box-shadow: inset 0 30px 60px rgba(0,0,0,0.6), 0 10px 40px rgba(0,0,0,0.45);
  overflow:hidden;
}
.btc-battery .post{
  position:absolute;top:-16px;width:60px;height:26px;border-radius:8px;background:linear-gradient(180deg,#fcd34d,#b45309);border:1px solid rgba(255,255,255,0.35);box-shadow:0 6px 14px rgba(0,0,0,0.4)
}
.btc-battery .post.left{left:80px}
.btc-battery .post.right{right:80px}
.btc-battery .emblem{
  position:absolute;top:10px;left:50%;transform:translateX(-50%);
  width:120px;height:120px;border-radius:50%;
  background: radial-gradient(circle at 30% 30%, #ffd79a, #f7931a 60%, #b45309 100%);
  border:2px solid rgba(255,255,255,0.35);box-shadow:0 8px 30px rgba(247,147,26,0.4), inset 0 8px 18px rgba(0,0,0,0.35);
  display:flex;align-items:center;justify-content:center;
  font-size:62px;font-weight:900;color:#0b1020;text-shadow:0 1px 0 rgba(255,255,255,0.5);
  z-index:3;
}
.btc-battery .inner{
  position:absolute;left:10px;right:10px;top:140px;bottom:60px;border-radius:22px;background:linear-gradient(180deg,#251400,#1a0e00);
  border:1px solid rgba(255,255,255,0.12);overflow:hidden;box-shadow: inset 0 16px 40px rgba(0,0,0,0.65)
}
#batteryCanvas{position:absolute;inset:10px}
.battery-gloss{position:absolute;inset:0;background: radial-gradient(600px 280px at 30% -10%, rgba(255,255,255,0.12), transparent);pointer-events:none}
.charge-bar{
  position:absolute;left:10px;right:10px;bottom:18px;height:16px;border-radius:10px;background:rgba(255,255,255,0.08);
  overflow:hidden;border:1px solid rgba(255,255,255,0.15)
}
.charge-bar::before{
  content:"";position:absolute;left:0;top:0;bottom:0;width:0;background:linear-gradient(90deg,#ffd79a,#f7931a);transition: width 0.35s ease;
}
.btc-battery .glow{position:absolute;inset:-40px;background:radial-gradient(800px 420px at 50% 20%, rgba(247,147,26,0.12), transparent 60%);pointer-events:none}

/* Dollar bills (draggable) */
.bill{
  position:absolute;width:150px;height:70px;border-radius:10px;cursor:grab;
  user-select:none;touch-action:none;
  background:
    radial-gradient(circle at 20% 50%, #a7f3d0 0 35px, transparent 36px),
    radial-gradient(circle at 80% 50%, #a7f3d0 0 35px, transparent 36px),
    linear-gradient(180deg,#047857,#065f46);
  border:2px solid #064e3b; box-shadow:0 10px 24px rgba(0,0,0,0.35);
}
.bill:active{cursor:grabbing}
.bill .seal{position:absolute;left:12px;top:12px;width:22px;height:22px;border-radius:50%;background:#34d399;opacity:0.8}
.bill .num{position:absolute;right:10px;top:8px;font-weight:900;color:#d1fae5}
.bill .progress{position:absolute;left:8px;bottom:6px;width:calc(100% - 16px);height:8px;border-radius:6px;background:rgba(255,255,255,0.12);overflow:hidden}
.bill .progress>span{display:block;height:100%;width:100%;background:linear-gradient(90deg,#22c55e,#f59e0b,#ef4444);transform-origin:left;}

/* Melt effect on bills when lost */
.bill.melting{
  animation: melt 1.2s ease-in forwards;
  position:absolute;
}
@keyframes melt{
  0%{filter: none; transform: translateY(0) scale(1) rotate(0deg); opacity:1}
  30%{filter: hue-rotate(-20deg) saturate(0.9) brightness(0.95)}
  50%{transform: translateY(12px) rotate(3deg)}
  70%{transform: translateY(22px) scale(0.98) rotate(-4deg); filter: blur(1px)}
  100%{transform: translateY(42px) scale(0.92) rotate(6deg); opacity:0}
}

/* Coins for tube travel */
.coin{
  position:fixed;width:26px;height:26px;border-radius:50%;
  background:radial-gradient(circle at 30% 30%, #ffd79a, #f7931a 60%, #b45309 100%);
  border:2px solid rgba(255,255,255,0.25);
  box-shadow: 0 8px 16px rgba(247,147,26,0.35);
  pointer-events:none;z-index:9;
}
.coin::before{content:"â‚¿"; position:absolute;inset:0; display:flex;align-items:center;justify-content:center;font-weight:900;color:#111827; text-shadow: 0 1px 0 rgba(255,255,255,0.35)}

/* Footer */
.footer{display:flex;justify-content:space-between;gap:20px;padding:14px 18px;color:var(--muted);border-top:1px solid rgba(255,255,255,0.08);background:rgba(0,0,0,0.25)}

@media (max-width: 1200px){
  .playfield{grid-template-columns: 1fr;}
  .btc-battery{width:96%}
}
